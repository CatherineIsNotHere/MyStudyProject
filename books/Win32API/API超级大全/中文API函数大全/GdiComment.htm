<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>GdiComment</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor=#E2DEE9>
<script language="JAVASCRIPT">
<!--
if (navigator.onLine){
document.write("<!-- Spidersoft WebZIP Ad Banner Insert -->");
document.write("<TABLE width=100% border=0 cellpadding=0 cellspacing=0>");
document.write("<TR>");
document.write("<TD>");
document.write("<ILAYER id=ad1 visibility=hidden height=60></ILAYER>");
document.write("<NOLAYER>");
document.write("<IFRAME SRC='http://www.spidersoft.com/ads/bwz468_60.htm' width=100% height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no></IFRAME>");
document.write("</NOLAYER>");
document.write("</TD>");
document.write("</TR>");
document.write("</TABLE>");
document.write("<!-- End of Spidersoft WebZIP Ad Banner Insert-->");
}
 //-->
</script>
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="GdiComment">GdiComment</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="102%" colspan="2">VB声明</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">Declare Function GdiComment Lib &quot;gdi32&quot; Alias
    &quot;GdiComment&quot; (ByVal hdc As Long, ByVal cbSize As Long, lpData As Byte) As Long</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">说明</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">为指定的增强型图元文件设备场景添加一条注释信息</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">返回值</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">Long，非零表示成功，零表示失败</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="77%">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">hdc</td>
    <td width="77%">Long，目标增强型图元文件设备场景的句柄</td>
  </tr>
  <tr>
    <td width="25%">cbSize</td>
    <td width="77%">Long，欲嵌入图元文件的数据长度</td>
  </tr>
  <tr>
    <td width="25%">lpData</td>
    <td width="77%">Byte，一个注释结构或一个缓冲区的Long内存地址，其中包含了欲添加的注释正文</td>
  </tr>
  <tr>
    <td width="102%" colspan="2">注解</td>
  </tr>
  <tr>
    <td width="102%" colspan="2"><p align="left">尽管可在图元文件中嵌入任何专用或私有（Private）信息，但只有几种全局数据格式能够嵌入。如将缓冲区看作一个32位Long型值的数组，则全局注释的值就是下面这个样子：<br>
    第一个条目是常数GDICOMMENT_IDENTIFIER<br>
    第二个条目如下所示：<br>
    首先是一个GDICOMMENT_WINDOWS_METAFILE――在增强型图元文件中嵌入一个标准图元文件。它的后面跟随下述值之一：<br>
    □&nbsp; 标准图元文件的版本号<br>
    □&nbsp; 一个校验和（checksum）值：所有图元文件数据的总和――包括这个值――必须是零<br>
    □&nbsp; 零<br>
    □&nbsp; 后面跟随的窗口图元文件的大小<br>
    GDICOMMENT_BEGINGROUP――标志一组绘图命令在增强型图元文件在中的起始处。它的后面跟随：<br>
    □&nbsp; 四个Long值。定义一个<a href="RECT.htm" tppabs="http://www.gxbcts.com/airfly/api/RECT.htm">RECT</a>结构。结构中包含了绘图命令的约束矩形<br>
    □&nbsp; 可选的Unicode字串的长度。字串中包含对命令组的说明文字。如不想提供说明，可设为零<br>
    GDICOMMENT_ENDGROUP――标志增强型图元文件中的一组绘图命令的结尾<br>
    GDICOMMENT_MULTIFORMATS――以不同的格式嵌入一幅处理过的图象。例如，可利用这个注释在一个增强型图元文件中嵌入一个封装式PostScript图象。回放这条记录的时候，windows会重画它能描绘的第一组格式。它的后面跟随：<br>
    □&nbsp; 四个Long值。定义一个<a href="RECT.htm" tppabs="http://www.gxbcts.com/airfly/api/RECT.htm">RECT</a>结构。结构中包含了绘图命令的约束矩形<br>
    □&nbsp; 包括在注释中的格式数量<br>
    □&nbsp; 一系列EMRFORMAT结构，每种格式使用一个</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#GdiComment">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
