<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>GetVolumeInformation</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor=#E2DEE9>
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="GetVolumeInformation">GetVolumeInformation</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="101%" colspan="3">VB声明</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">Declare Function GetVolumeInformation Lib
    &quot;kernel32&quot; Alias &quot;GetVolumeInformationA&quot; (ByVal lpRootPathName As
    String, ByVal lpVolumeNameBuffer As String, ByVal nVolumeNameSize As Long,
    lpVolumeSerialNumber As Long, lpMaximumComponentLength As Long, lpFileSystemFlags As Long,
    ByVal lpFileSystemNameBuffer As String, ByVal nFileSystemNameSize As Long) As Long</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">说明</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">获取与一个磁盘卷有关的信息</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">返回值</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">Long，非零表示成功，零表示失败。会设置<a
    href="GetLastError.htm" tppabs="http://www.gxbcts.com/airfly/api/GetLastError.htm">GetLastError</a></td>
  </tr>
  <tr>
    <td width="101%" colspan="3">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="76%" colspan="2">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">lpRootPathName</td>
    <td width="76%" colspan="2">String，欲获取信息的那个卷的根路径</td>
  </tr>
  <tr>
    <td width="25%">lpVolumeNameBuffer</td>
    <td width="76%" colspan="2">String，用于装载卷名（卷标）的一个字串</td>
  </tr>
  <tr>
    <td width="25%">nVolumeNameSize</td>
    <td width="76%" colspan="2">Long，lpVolumeNameBuffer字串的长度</td>
  </tr>
  <tr>
    <td width="25%">lpVolumeSerialNumber</td>
    <td width="76%" colspan="2">Long，用于装载磁盘卷序列号的变量</td>
  </tr>
  <tr>
    <td width="25%">lpMaximumComponentLength</td>
    <td width="76%" colspan="2">Long，指定一个变量，用于装载文件名每一部分的长度。例如，在“c:\component1\component2.ext”的情况下，它就代表component1或component2名称的长度</td>
  </tr>
  <tr>
    <td width="25%" rowspan="7">lpFileSystemFlags</td>
    <td width="76%" colspan="2">Long，用于装载一个或多个二进制位标志的变量。对这些标志位的解释如下：</td>
  </tr>
  <tr>
    <td width="37%">FS_CASE_IS_PRESERVED</td>
    <td width="38%">文件名的大小写记录于文件系统</td>
  </tr>
  <tr>
    <td width="37%">FS_CASE_SENSITIVE</td>
    <td width="38%">文件名要区分大小写</td>
  </tr>
  <tr>
    <td width="37%">FS_UNICODE_STORED_ON_DISK</td>
    <td width="38%">文件名保存为Unicode格式</td>
  </tr>
  <tr>
    <td width="37%">FS_PERSISTANT_ACLS</td>
    <td width="38%">文件系统支持文件的访问控制列表（ACL）安全机制</td>
  </tr>
  <tr>
    <td width="37%">FS_FILE_COMPRESSION</td>
    <td width="38%">文件系统支持逐文件的进行文件压缩</td>
  </tr>
  <tr>
    <td width="37%">FS_VOL_IS_COMPRESSED</td>
    <td width="38%">整个磁盘卷都是压缩的</td>
  </tr>
  <tr>
    <td width="25%">lpFileSystemNameBuffer</td>
    <td width="76%" colspan="2">String，指定一个缓冲区，用于装载文件系统的名称（如FAT，NTFS以及其他）</td>
  </tr>
  <tr>
    <td width="25%">nFileSystemNameSize</td>
    <td width="76%" colspan="2">Long，lpFileSystemNameBuffer字串的长度</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#GetVolumeInformation">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
