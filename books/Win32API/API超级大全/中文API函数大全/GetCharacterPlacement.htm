<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>GetCharacterPlacement</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor=#E2DEE9>
<script language="JAVASCRIPT">
<!--
if (navigator.onLine){
document.write("<!-- Spidersoft WebZIP Ad Banner Insert -->");
document.write("<TABLE width=100% border=0 cellpadding=0 cellspacing=0>");
document.write("<TR>");
document.write("<TD>");
document.write("<ILAYER id=ad1 visibility=hidden height=60></ILAYER>");
document.write("<NOLAYER>");
document.write("<IFRAME SRC='http://www.spidersoft.com/ads/bwz468_60.htm' width=100% height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no></IFRAME>");
document.write("</NOLAYER>");
document.write("</TD>");
document.write("</TR>");
document.write("</TABLE>");
document.write("<!-- End of Spidersoft WebZIP Ad Banner Insert-->");
}
 //-->
</script>
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="GetCharacterPlacement">GetCharacterPlacement</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="100%" colspan="3">VB声明</td>
  </tr>
  <tr>
    <td width="100%" colspan="3">Declare Function GetCharacterPlacement Lib &quot;gdi32&quot;
    Alias &quot; GetCharacterPlacementA&quot; (ByVal hdc As Long, ByVal lpsz As String, ByVal
    n1 As Long, ByVal n2 As Long, lpGcpResults As GCP_RESULTS, ByVal dw As Long) As Long</td>
  </tr>
  <tr>
    <td width="100%" colspan="3">说明</td>
  </tr>
  <tr>
    <td width="100%" colspan="3">该函数用于了解如何用一个给定的字符显示一个字串</td>
  </tr>
  <tr>
    <td width="100%" colspan="3">返回值</td>
  </tr>
  <tr>
    <td width="100%" colspan="3">Long，非零表示成功，零表示失败。会设置<a
    href="GetLastError.htm" tppabs="http://www.gxbcts.com/airfly/api/GetLastError.htm">GetLastError</a></td>
  </tr>
  <tr>
    <td width="100%" colspan="3">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="75%" colspan="2">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">hdc</td>
    <td width="75%" colspan="2">Long，设备场景的句柄</td>
  </tr>
  <tr>
    <td width="25%">lpsz</td>
    <td width="75%" colspan="2">String，欲分析的字串</td>
  </tr>
  <tr>
    <td width="25%">n1</td>
    <td width="75%" colspan="2">Long，字串的长度</td>
  </tr>
  <tr>
    <td width="25%">n2</td>
    <td width="75%" colspan="2">Long，若在dw参数中指定了GCP_MAXEXTENT常数，那么一旦显示的字串超出了由该参数指定的宽度（用逻辑单位），函数就会停止处理字串</td>
  </tr>
  <tr>
    <td width="25%">lpGcpResults</td>
    <td width="75%" colspan="2">GCP_RESULTS，在这个结构中装载为这个字串计算出来的信息</td>
  </tr>
  <tr>
    <td width="25%" rowspan="10">dw</td>
    <td width="75%" colspan="2">Long，下述常数的一个或多个：</td>
  </tr>
  <tr>
    <td width="38%">GCP_CLASSIN</td>
    <td width="37%">lpGcpResults结构中的lpClass数组包含了字串中各字符的分类信息</td>
  </tr>
  <tr>
    <td width="38%">GCP_DIACRITIC</td>
    <td width="37%">在计算时将发音符和“废”字符考虑在内</td>
  </tr>
  <tr>
    <td width="38%">GCP_DISPLAYZWG</td>
    <td width="37%">显示某些字符集中使用的不可见字符，根据它们在一个词中的位置修改字符</td>
  </tr>
  <tr>
    <td width="38%">GCP_GLPYPHSHAPE</td>
    <td width="37%">允许对字样（字面）进行特殊处理。根据<a
    href="GetFontLanguageInfo.htm" tppabs="http://www.gxbcts.com/airfly/api/GetFontLanguageInfo.htm">GetFontLanguageInfo</a>函数的结果使用</td>
  </tr>
  <tr>
    <td width="38%">GCP_JUSTIFY</td>
    <td width="37%">调整字样位置，对字串进行对齐处理，使其与n2参数指定的范围相符</td>
  </tr>
  <tr>
    <td width="38%">GCP_JUSTIFYIN</td>
    <td width="37%">lpGcpResults结构中的lpDX参数包含了计算过程中使用的对齐粗细设置</td>
  </tr>
  <tr>
    <td width="38%">GCP_LIGATE</td>
    <td width="37%">如当前字体支持，就用连字技术将字符合并成单独一个字符</td>
  </tr>
  <tr>
    <td width="38%">GCP_MAXEXTENT</td>
    <td width="37%">请参考对n2参数的说明</td>
  </tr>
  <tr>
    <td width="38%">GCP_USERKERNING</td>
    <td width="37%">计算字符位置时，使用字距表（如果有的话）可用其他标志对希伯来和阿拉伯字体进行特殊处理。这类语言按照从右到左的顺序显示文字，而且具体显示的字样由字符在一个词中的位置决定</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#GetCharacterPlacement">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
