<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>RegQueryInfoKey</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor="#FFC8C8">
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="RegQueryInfoKey">RegQueryInfoKey</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="100%" colspan="2">VB声明</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">Declare Function RegQueryInfoKey Lib &quot;advapi32.dll&quot; 
    Alias &quot;RegQueryInfoKeyA&quot; (ByVal hKey As Long, ByVal lpClass As String, lpcbClass 
    As Long, lpReserved As Long, lpcSubKeys As Long, lpcbMaxSubKeyLen As Long, lpcbMaxClassLen 
    As Long, lpcValues As Long, lpcbMaxValueNameLen As Long, lpcbMaxValueLen As Long, 
    lpcbSecurityDescriptor As Long, lpftLastWriteTime As FILETIME) As Long</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">说明</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">获取与一个项有关的信息</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">返回值</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">Long，零（ERROR_SUCCESS）表示成功。其他任何值都代表一个错误代码。如一个缓冲区的长度不够，不能容下返回的数据，则函数会返回ERROR_MORE_DATA</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="75%">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">hKey</td>
    <td width="75%">Long，一个已打开项的句柄，或指定一个标准项名</td>
  </tr>
  <tr>
    <td width="25%">lpClass</td>
    <td width="75%">String，指定一个字串，用于装载这个注册表项的类名</td>
  </tr>
  <tr>
    <td width="25%">lpcbClass</td>
    <td width="75%">Long，指定一个变量，用于装载lpClass缓冲区的长度。一旦返回，它会设为实际装载到缓冲区的字节数量</td>
  </tr>
  <tr>
    <td width="25%">lpReserved</td>
    <td width="75%">Long，未用，设为零</td>
  </tr>
  <tr>
    <td width="25%">lpcSubKeys</td>
    <td width="75%">Long，用于装载（保存）这个项的子项数量的一个变量</td>
  </tr>
  <tr>
    <td width="25%">lpcbMaxSubKeyLen</td>
    <td width="75%">Long，指定一个变量，用于装载这个项最长一个子项的长度。注意这个长度不包括空中止字符</td>
  </tr>
  <tr>
    <td width="25%">lpcbMaxClassLen</td>
    <td width="75%">Long，指定一个变量，用于装载这个项之子项的最长一个类名的长度。注意这个长度不包括空中止字符</td>
  </tr>
  <tr>
    <td width="25%">lpcValues</td>
    <td width="75%">Long，用于装载这个项的设置值数量的一个变量</td>
  </tr>
  <tr>
    <td width="25%">lpcbMaxValueNameLen</td>
    <td width="75%">Long，指定一个变量，用于装载这个项之子项的最长一个值名的长度。注意这个长度不包括空中止字符</td>
  </tr>
  <tr>
    <td width="25%">lpcbMaxValueLen</td>
    <td width="75%">Long，指定一个变量，用于装载容下这个项最长一个值数据所需的缓冲区长度</td>
  </tr>
  <tr>
    <td width="25%">lpcbSecurityDescriptor</td>
    <td width="75%">Long，装载值安全描述符长度的一个变量</td>
  </tr>
  <tr>
    <td width="25%">lpftLastWriteTime</td>
    <td width="75%"><a href="FILETIME.htm" tppabs="http://personal.hb.cninfo.net/~vbapi/FILETIME.htm">FILETIME</a>，指定一个结构，用于容纳该项的上一次修改时间</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#RegQueryInfoKey">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
