<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>StretchDIBits</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor="#FFC8C8">
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="StretchDIBits">StretchDIBits</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="101%" colspan="3">VB声明</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">Declare Function StretchDIBits Lib &quot;gdi32&quot; Alias 
    &quot;StretchDIBits&quot; (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal dx 
    As Long, ByVal dy As Long, ByVal SrcX As Long, ByVal SrcY As Long, ByVal wSrcWidth As 
    Long, ByVal wSrcHeight As Long, lpBits As Any, lpBitsInfo As BITMAPINFO, ByVal wUsage As 
    Long, ByVal dwRop As Long) As Long</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">说明</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">将一幅与设备无关位图的全部或部分数据直接复制到指定的设备场景。这个函数在设备场景中定义了一个目标矩形，用于接收位图数据。它也在DIB中定义了一个源矩形，以便从中提取数据。根据设备场景的<a
    href="StretchBlt.htm" tppabs="http://personal.hb.cninfo.net/~vbapi/StretchBlt.htm">StretchBlt</a>模式（由<a href="SetStretchBltMode.htm" tppabs="http://personal.hb.cninfo.net/~vbapi/SetStretchBltMode.htm">SetStretchBltMode</a>函数决定），源矩形会根据需要调整，以便符合目标矩形的要求</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">返回值</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">Long，如函数执行成功，返回欲复制的扫描线的数量；如返回常数GDI_ERROR，表示出错</td>
  </tr>
  <tr>
    <td width="101%" colspan="3">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="76%" colspan="2">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">hdc</td>
    <td width="78%" colspan="2">Long，一个设备场景的句柄。该场景用于接收位图数据</td>
  </tr>
  <tr>
    <td width="25%">x,y</td>
    <td width="78%" colspan="2">Long，用逻辑坐标表示的目标矩形的起点</td>
  </tr>
  <tr>
    <td width="25%">dx,dy</td>
    <td width="78%" colspan="2">Long，目标矩形的宽度及高度，以逻辑坐标表示</td>
  </tr>
  <tr>
    <td width="25%">SrcX,SrcY</td>
    <td width="78%" colspan="2">Long，用设备坐标表示的源矩形在DIB中的起点</td>
  </tr>
  <tr>
    <td width="25%">wSrcWidth,wSrcHeight</td>
    <td width="78%" colspan="2">Long，源矩形的宽度与高度，用设备坐标表示。如其中有一个参数的符号（指正负号）与对应的目标参数不符，位图就会在对应的轴上作镜像转换</td>
  </tr>
  <tr>
    <td width="25%">lpBits</td>
    <td width="78%" colspan="2">Any，指向一个缓冲区的指针。这个缓冲区包含了以DIB格式描述的位图数据；这种格式是由lpBitsInfo指定的</td>
  </tr>
  <tr>
    <td width="25%">lpBitsInfo</td>
    <td width="78%" colspan="2">BITMAPINFO，对lpBits DIB的格式和颜色进行描述的一个结构</td>
  </tr>
  <tr>
    <td width="25%" rowspan="3">wUsage</td>
    <td width="76%" colspan="2">Long，下述常数之一</td>
  </tr>
  <tr>
    <td width="37%">DIB_PAL_COLORS</td>
    <td width="38%">颜色表是一个整数数组，其中包含了与目前选入hdc设备场景的调色板相关的索引</td>
  </tr>
  <tr>
    <td width="37%">DIB_RGB_COLORS</td>
    <td width="38%">颜色表包含了RG颜色</td>
  </tr>
  <tr>
    <td width="25%">dwRop</td>
    <td width="76%" colspan="2">Long，欲进行的光栅运算</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#StretchDIBits">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
