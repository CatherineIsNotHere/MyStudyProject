<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>LoadKeyboardLayout</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor="#FFC8C8">
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="LoadKeyboardLayout">LoadKeyboardLayout</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="102%" colspan="3">VB声明</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">Declare Function LoadKeyboardLayout Lib &quot;user32&quot; 
    Alias &quot;LoadKeyboardLayoutA&quot; (ByVal pwszKLID As String, ByVal flags As Long) As 
    Long</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">说明</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">载入一个键盘布局</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">返回值</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">Long，键盘布局的句柄。零表示出错</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="77%" colspan="2">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">pwszKLID</td>
    <td width="77%" colspan="2">String，一个8字符字串，用于描述键盘布局的名称。参考注解</td>
  </tr>
  <tr>
    <td width="25%" rowspan="7">flags</td>
    <td width="77%" colspan="2">Long，下述常数的任何一种组合</td>
  </tr>
  <tr>
    <td width="37%">KLF_ACTIVATE</td>
    <td width="38%">载入和激活指定的布局</td>
  </tr>
  <tr>
    <td width="37%">KLF_NOTELLSHELL</td>
    <td width="38%">禁止一个外壳挂钩进程（a shell hook procedure）接收到HSHELL_LANGUAGE通告。如准备载入一系列键盘布局，就需要考虑设置这个标志，从而改善性能（不要为最后一个载入的布局设置该标志）</td>
  </tr>
  <tr>
    <td width="37%">KLF_REORDER</td>
    <td width="38%">将指定的活动布局移至内部键盘布局列表的起始处</td>
  </tr>
  <tr>
    <td width="37%">KLF_REPLACELANG</td>
    <td width="38%">如指定语言的键盘布局已经存在，则用这个将其替换。仅适用于win95</td>
  </tr>
  <tr>
    <td width="37%">KLF_SUBSTITUTE_OK</td>
    <td width="38%">在注册表中使用替换信息，为这个语言载入一个由用户指定的替换键盘布局（如果存在的话），而不是载入当前这个布局</td>
  </tr>
  <tr>
    <td width="37%">KLF_UNLOADPREVIOUS</td>
    <td width="38%">如KLF_ACTIVATE已经指定并成功，则卸载前一个布局</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">注解</td>
  </tr>
  <tr>
    <td width="102%" colspan="3"><p align="left">键盘布局的名称采用“ddddnnnn”的形式。其中，nnnn代表一个语言ID的字串形式，而dddd代表一个设备代码的字串形式。标准的美国键盘名称是“00000409”</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">其他</td>
  </tr>
  <tr>
    <td width="102%" colspan="3">键盘布局在win95中取决于特定的线程；在windows 
    nt中，则在整个系统的范围内有效</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#LoadKeyboardLayout">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
