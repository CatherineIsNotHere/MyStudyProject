<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style><!--
body,table {font-family:"宋体"; font-size: 9pt; line-height:11pt;}
a {text-decoration:none} a:hover {color:red;text-decoration:underline}
--></style>
<title>ModifyMenu</title>
</head>

<body link="#FF0000" vlink="#FF0000" alink="#FF0000" bgcolor="#FFC8C8">
<div align="center"><center>

<table border="0" width="100%" height="22" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" height="16"><a name="ModifyMenu,ModifyMenuBynum">ModifyMenu,ModifyMenuBynum</a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" bordercolorlight="#808080" cellspacing="0"
bordercolordark="#FFFFFF">
  <tr>
    <td width="100%" colspan="2">VB声明</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">Declare Function ModifyMenu&amp; Lib &quot;user32&quot; Alias 
    &quot;ModifyMenuA&quot; (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As 
    Long, ByVal wIDNewItem As Long, ByVal lpString As String)<br>
    Declare Function ModifyMenuBynum&amp; Lib &quot;user32&quot; Alias &quot;ModifyMenuA&quot; 
    (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As Long, ByVal wIDNewItem As 
    Long, ByVal lpString As Long)</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">说明</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">改变菜单条目。在vb里这个函数做出的许多改变都会有效的执行，但不能由vb菜单对象反映出来</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">返回值</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">Long，非零表示成功，零表示失败。会设置<a
    href="GetLastError.htm" tppabs="http://personal.hb.cninfo.net/~vbapi/GetLastError.htm">GetLastError</a></td>
  </tr>
  <tr>
    <td width="100%" colspan="2">参数表</td>
  </tr>
  <tr>
    <td width="25%">参数</td>
    <td width="75%">类型及说明</td>
  </tr>
  <tr>
    <td width="25%">hMenu</td>
    <td width="75%">Long，菜单句柄</td>
  </tr>
  <tr>
    <td width="25%">nPosition</td>
    <td width="75%">Long，欲改变的菜单条目的标识符。如在wFlags参数中指定了MF_BYCOMMAND，这个参数就代表欲改变的菜单条目的命令ID。如设置的是MF_BYPOSITION，这个参数就代表菜单条目在菜单中的位置（第一个条目的位置为零）</td>
  </tr>
  <tr>
    <td width="25%">wFlags</td>
    <td width="75%">Long，一系列常数标志的组合。详见<a
    href="#菜单常数标志表">菜单常数标志表</a></td>
  </tr>
  <tr>
    <td width="25%">wIDNewItem</td>
    <td width="75%">Long，指定菜单条目的新命令ID。如在wFlags参数中指定了MF_POPUP标志，就应是一个弹出式菜单的句柄</td>
  </tr>
  <tr>
    <td width="25%">lpString</td>
    <td width="75%">String或Long，如在wFlags参数中指定了MF_STRING标志，就代表欲设置到菜单的字串。如设置的是MF_BITMAP，就代表一个Long变量，其中包含了一个位图句柄。如设置的是MF_OWNERDRAW，那么这个值就会包括到DRAWITEMSTRUCT和MEASUREITEMSTRUCT结构中，并由windows在条目需要重画的时候发出</td>
  </tr>
  <tr>
    <td width="100%" colspan="2">注解</td>
  </tr>
  <tr>
    <td width="100%" colspan="2"><p align="left">标志的下述组合形式是不允许的：MF_BYCOMMAND和MF_BYPOSITION；MF_CHECKED和MF_UNCHECKED；MF_MENUBARBREAK和MF_MENUBREAK；MF_DISABLED，MF_ENABLED和MF_GRAYED；MF_BITMAP，MF_STRING，MF_OWNERDRAW和MF_SEPARATOR</td>
  </tr>
  <tr>
    <td width="100%" colspan="2"><a name="菜单常数标志表">菜单常数标志表</a></td>
  </tr>
  <tr>
    <td width="25%">MF_BITMAP</td>
    <td width="75%">菜单条目是一幅位图。一旦设入菜单，这幅位图就绝对不能删除。所以不应该使用由vb的image属性返回的值</td>
  </tr>
  <tr>
    <td width="25%">MF_BYCOMMAND</td>
    <td width="75%">菜单条目由菜单的命令ID指定</td>
  </tr>
  <tr>
    <td width="25%">MF_BYPOSITION</td>
    <td width="75%">菜单条目由条目在菜单中的位置决定。零代表菜单中的第一个条目</td>
  </tr>
  <tr>
    <td width="25%">MF_CHECKED</td>
    <td width="75%">检查指定的菜单条目。不能与vb的checked属性兼容</td>
  </tr>
  <tr>
    <td width="25%">MF_DISABLED</td>
    <td width="75%">禁止指定的菜单条目。不与vb的enabled属性兼容</td>
  </tr>
  <tr>
    <td width="25%">MF_ENABLED</td>
    <td width="75%">允许指定的菜单条目。不与vb的enabled属性兼容</td>
  </tr>
  <tr>
    <td width="25%">MF_GRAYED</td>
    <td width="75%">禁止指定的菜单条目，并用浅灰色描述它。不与vb的enabled属性兼容</td>
  </tr>
  <tr>
    <td width="25%">MF_MENUBARBREAK</td>
    <td width="75%">在弹出式菜单中，将指定的条目放置于一个新列，并用一条垂直线分隔不同的列</td>
  </tr>
  <tr>
    <td width="25%">MF_MENUBREAK</td>
    <td width="75%">在弹出式菜单中，将指定的条目放置于一个新列。在顶级菜单中，将条目放置到一个新行</td>
  </tr>
  <tr>
    <td width="25%">MF_OWNERDRAW</td>
    <td width="75%">创建一个物主绘图菜单（由您设计的程序负责描绘每个菜单条目）</td>
  </tr>
  <tr>
    <td width="25%">MF_POPUP</td>
    <td width="75%">将一个弹出式菜单置于指定的条目。可用于创建子菜单及弹出式菜单</td>
  </tr>
  <tr>
    <td width="25%">MF_SEPARATOR</td>
    <td width="75%">在指定的条目处显示一条分隔线</td>
  </tr>
  <tr>
    <td width="25%">MF_STRING</td>
    <td width="75%">在指定的条目处放置一个字串。不与vb的caption属性兼容</td>
  </tr>
  <tr>
    <td width="25%">MF_UNCHECKED</td>
    <td width="75%">检查指定的条目。不能与vb的checked属性兼容</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><p align="right"><a href="#ModifyMenu,ModifyMenuBynum">Top</a></td>
  </tr>
</table>
</center></div>
</body>
</html>
